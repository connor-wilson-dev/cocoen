{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/cocoen.js"],"names":[],"mappings":"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","file":"cocoen.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class Cocoen {\n  constructor(element, options) {\n    this.options = Object.assign({}, Cocoen.defaults, options);\n    this.element = element || document.querySelector('.cocoen');\n\n    this.init();\n  }\n\n  init() {\n    // If already active, escape\n    if (this.isActive) return;\n    this.createElements();\n    this.addEventListeners();\n    this.dimensions();\n\n    // Set flag\n    this.isActive = true;\n  }\n\n  destroy() {\n    if (!this.isActive) return;\n\n    this.removeEventListeners();\n    this.destroyElements();\n    this.cleanUp();\n\n    this.isActive = false;\n  }\n\n  createElements() {\n    // Create drag element\n    const span = document.createElement('span');\n    span.className = this.options.dragElementSelector.replace('.', '');\n    this.element.appendChild(span);\n    // Wrap first image in div\n    const wrapper = document.createElement('div');\n    const firstImage = this.element.querySelector('img:first-child');\n    wrapper.appendChild(firstImage.cloneNode(true));\n    firstImage.parentNode.replaceChild(wrapper, firstImage);\n    // Set class elements we need later\n    this.dragElement = this.element.querySelector(this.options.dragElementSelector);\n    this.beforeElement = this.element.querySelector('div:first-child');\n    this.beforeImage = this.beforeElement.querySelector('img');\n  }\n\n  destroyElements() {\n    this.element.replaceChild(this.beforeImage, this.beforeElement);\n    this.element.removeChild(this.dragElement);\n  }\n\n  addEventListeners() {\n    this.element.addEventListener('click', this.onTap.bind(this));\n    this.element.addEventListener('mousemove', this.onDrag.bind(this));\n    this.element.addEventListener('touchmove', this.onDrag.bind(this));\n    this.dragElement.addEventListener('mousedown', this.onDragStart.bind(this));\n    this.dragElement.addEventListener('touchstart', this.onDragStart.bind(this));\n\n    window.addEventListener('mouseup', this.onDragEnd.bind(this));\n    window.addEventListener('resize', this.dimensions.bind(this));\n  }\n\n  removeEventListeners() {\n    this.element.removeEventListener('click', this.onTap.bind(this));\n    this.element.removeEventListener('mousemove', this.onDrag.bind(this));\n    this.element.removeEventListener('touchmove', this.onDrag.bind(this));\n    this.dragElement.removeEventListener('mousedown', this.onDragStart.bind(this));\n    this.dragElement.removeEventListener('touchstart', this.onDragStart.bind(this));\n\n    window.removeEventListener('mouseup', this.onDragEnd.bind(this));\n    window.removeEventListener('resize', this.dimensions.bind(this));\n  }\n\n  cleanUp() {\n    this.dragElement = null;\n    this.beforeElement = null;\n    this.beforeImage.style.removeProperty('width');\n  }\n\n  dimensions() {\n    this.elementWidth = parseInt(window.getComputedStyle(this.element).width, 10);\n    this.elementOffsetLeft = this.element.getBoundingClientRect().left + document.body.scrollLeft;\n    this.beforeImage.style.width = `${this.elementWidth}px`;\n    this.dragElementWidth = parseInt(window.getComputedStyle(this.dragElement).width, 10);\n    this.minLeftPos = this.elementOffsetLeft + 10;\n    this.maxLeftPos = (this.elementOffsetLeft + this.elementWidth) - this.dragElementWidth - 10;\n  }\n\n  onTap(e) {\n    e.preventDefault();\n\n    this.leftPos = (e.pageX) ? e.pageX : e.touches[0].pageX;\n    this.requestDrag();\n  }\n\n  onDragStart(e) {\n    e.preventDefault();\n\n    const startX = (e.pageX) ? e.pageX : e.touches[0].pageX;\n    const offsetLeft = this.dragElement.getBoundingClientRect().left + document.body.scrollLeft;\n    this.posX = (offsetLeft + this.dragElementWidth) - startX;\n    this.isDragging = true;\n  }\n\n  onDragEnd(e) {\n    e.preventDefault();\n    this.isDragging = false;\n  }\n\n  onDrag(e) {\n    e.preventDefault();\n\n    if (!this.isDragging) {\n      return;\n    }\n\n    this.moveX = (e.pageX) ? e.pageX : e.touches[0].pageX;\n    this.leftPos = (this.moveX + this.posX) - this.dragElementWidth;\n\n    this.requestDrag();\n  }\n\n  drag() {\n    if (this.leftPos < this.minLeftPos) {\n      this.leftPos = this.minLeftPos;\n    } else if (this.leftPos > this.maxLeftPos) {\n      this.leftPos = this.maxLeftPos;\n    }\n\n    let openRatio = (this.leftPos + (this.dragElementWidth / 2)) - this.elementOffsetLeft;\n    openRatio /= this.elementWidth;\n    const width = `${openRatio * 100}%`;\n\n    this.dragElement.style.left = width;\n    this.beforeElement.style.width = width;\n\n    if (this.options.dragCallback) {\n      this.options.dragCallback(openRatio);\n    }\n  }\n\n  requestDrag() {\n    window.requestAnimationFrame(this.drag.bind(this));\n  }\n}\n\nCocoen.defaults = {\n  dragElementSelector: '.cocoen-drag',\n  dragCallback: null,\n};\n\nmodule.exports = Cocoen;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29jb2VuLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7SUNBTSxNO0FBQ0osa0JBQVksT0FBWixFQUFxQixPQUFyQixFQUE4QjtBQUFBOztBQUM1QixTQUFLLE9BQUwsR0FBZSxTQUFjLEVBQWQsRUFBa0IsT0FBTyxRQUF6QixFQUFtQyxPQUFuQyxDQUFmO0FBQ0EsU0FBSyxPQUFMLEdBQWUsV0FBVyxTQUFTLGFBQVQsQ0FBdUIsU0FBdkIsQ0FBMUI7O0FBRUEsU0FBSyxJQUFMO0FBQ0Q7Ozs7MkJBRU07QUFDTDtBQUNBLFVBQUksS0FBSyxRQUFULEVBQW1CO0FBQ25CLFdBQUssY0FBTDtBQUNBLFdBQUssaUJBQUw7QUFDQSxXQUFLLFVBQUw7O0FBRUE7QUFDQSxXQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDRDs7OzhCQUVTO0FBQ1IsVUFBSSxDQUFDLEtBQUssUUFBVixFQUFvQjs7QUFFcEIsV0FBSyxvQkFBTDtBQUNBLFdBQUssZUFBTDtBQUNBLFdBQUssT0FBTDs7QUFFQSxXQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDRDs7O3FDQUVnQjtBQUNmO0FBQ0EsVUFBTSxPQUFPLFNBQVMsYUFBVCxDQUF1QixNQUF2QixDQUFiO0FBQ0EsV0FBSyxTQUFMLEdBQWlCLEtBQUssT0FBTCxDQUFhLG1CQUFiLENBQWlDLE9BQWpDLENBQXlDLEdBQXpDLEVBQThDLEVBQTlDLENBQWpCO0FBQ0EsV0FBSyxPQUFMLENBQWEsV0FBYixDQUF5QixJQUF6QjtBQUNBO0FBQ0EsVUFBTSxVQUFVLFNBQVMsYUFBVCxDQUF1QixLQUF2QixDQUFoQjtBQUNBLFVBQU0sYUFBYSxLQUFLLE9BQUwsQ0FBYSxhQUFiLENBQTJCLGlCQUEzQixDQUFuQjtBQUNBLGNBQVEsV0FBUixDQUFvQixXQUFXLFNBQVgsQ0FBcUIsSUFBckIsQ0FBcEI7QUFDQSxpQkFBVyxVQUFYLENBQXNCLFlBQXRCLENBQW1DLE9BQW5DLEVBQTRDLFVBQTVDO0FBQ0E7QUFDQSxXQUFLLFdBQUwsR0FBbUIsS0FBSyxPQUFMLENBQWEsYUFBYixDQUEyQixLQUFLLE9BQUwsQ0FBYSxtQkFBeEMsQ0FBbkI7QUFDQSxXQUFLLGFBQUwsR0FBcUIsS0FBSyxPQUFMLENBQWEsYUFBYixDQUEyQixpQkFBM0IsQ0FBckI7QUFDQSxXQUFLLFdBQUwsR0FBbUIsS0FBSyxhQUFMLENBQW1CLGFBQW5CLENBQWlDLEtBQWpDLENBQW5CO0FBQ0Q7OztzQ0FFaUI7QUFDaEIsV0FBSyxPQUFMLENBQWEsWUFBYixDQUEwQixLQUFLLFdBQS9CLEVBQTRDLEtBQUssYUFBakQ7QUFDQSxXQUFLLE9BQUwsQ0FBYSxXQUFiLENBQXlCLEtBQUssV0FBOUI7QUFDRDs7O3dDQUVtQjtBQUNsQixXQUFLLE9BQUwsQ0FBYSxnQkFBYixDQUE4QixPQUE5QixFQUF1QyxLQUFLLEtBQUwsQ0FBVyxJQUFYLENBQWdCLElBQWhCLENBQXZDO0FBQ0EsV0FBSyxPQUFMLENBQWEsZ0JBQWIsQ0FBOEIsV0FBOUIsRUFBMkMsS0FBSyxNQUFMLENBQVksSUFBWixDQUFpQixJQUFqQixDQUEzQztBQUNBLFdBQUssT0FBTCxDQUFhLGdCQUFiLENBQThCLFdBQTlCLEVBQTJDLEtBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsSUFBakIsQ0FBM0M7QUFDQSxXQUFLLFdBQUwsQ0FBaUIsZ0JBQWpCLENBQWtDLFdBQWxDLEVBQStDLEtBQUssV0FBTCxDQUFpQixJQUFqQixDQUFzQixJQUF0QixDQUEvQztBQUNBLFdBQUssV0FBTCxDQUFpQixnQkFBakIsQ0FBa0MsWUFBbEMsRUFBZ0QsS0FBSyxXQUFMLENBQWlCLElBQWpCLENBQXNCLElBQXRCLENBQWhEOztBQUVBLGFBQU8sZ0JBQVAsQ0FBd0IsU0FBeEIsRUFBbUMsS0FBSyxTQUFMLENBQWUsSUFBZixDQUFvQixJQUFwQixDQUFuQztBQUNBLGFBQU8sZ0JBQVAsQ0FBd0IsUUFBeEIsRUFBa0MsS0FBSyxVQUFMLENBQWdCLElBQWhCLENBQXFCLElBQXJCLENBQWxDO0FBQ0Q7OzsyQ0FFc0I7QUFDckIsV0FBSyxPQUFMLENBQWEsbUJBQWIsQ0FBaUMsT0FBakMsRUFBMEMsS0FBSyxLQUFMLENBQVcsSUFBWCxDQUFnQixJQUFoQixDQUExQztBQUNBLFdBQUssT0FBTCxDQUFhLG1CQUFiLENBQWlDLFdBQWpDLEVBQThDLEtBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsSUFBakIsQ0FBOUM7QUFDQSxXQUFLLE9BQUwsQ0FBYSxtQkFBYixDQUFpQyxXQUFqQyxFQUE4QyxLQUFLLE1BQUwsQ0FBWSxJQUFaLENBQWlCLElBQWpCLENBQTlDO0FBQ0EsV0FBSyxXQUFMLENBQWlCLG1CQUFqQixDQUFxQyxXQUFyQyxFQUFrRCxLQUFLLFdBQUwsQ0FBaUIsSUFBakIsQ0FBc0IsSUFBdEIsQ0FBbEQ7QUFDQSxXQUFLLFdBQUwsQ0FBaUIsbUJBQWpCLENBQXFDLFlBQXJDLEVBQW1ELEtBQUssV0FBTCxDQUFpQixJQUFqQixDQUFzQixJQUF0QixDQUFuRDs7QUFFQSxhQUFPLG1CQUFQLENBQTJCLFNBQTNCLEVBQXNDLEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBb0IsSUFBcEIsQ0FBdEM7QUFDQSxhQUFPLG1CQUFQLENBQTJCLFFBQTNCLEVBQXFDLEtBQUssVUFBTCxDQUFnQixJQUFoQixDQUFxQixJQUFyQixDQUFyQztBQUNEOzs7OEJBRVM7QUFDUixXQUFLLFdBQUwsR0FBbUIsSUFBbkI7QUFDQSxXQUFLLGFBQUwsR0FBcUIsSUFBckI7QUFDQSxXQUFLLFdBQUwsQ0FBaUIsS0FBakIsQ0FBdUIsY0FBdkIsQ0FBc0MsT0FBdEM7QUFDRDs7O2lDQUVZO0FBQ1gsV0FBSyxZQUFMLEdBQW9CLFNBQVMsT0FBTyxnQkFBUCxDQUF3QixLQUFLLE9BQTdCLEVBQXNDLEtBQS9DLEVBQXNELEVBQXRELENBQXBCO0FBQ0EsV0FBSyxpQkFBTCxHQUF5QixLQUFLLE9BQUwsQ0FBYSxxQkFBYixHQUFxQyxJQUFyQyxHQUE0QyxTQUFTLElBQVQsQ0FBYyxVQUFuRjtBQUNBLFdBQUssV0FBTCxDQUFpQixLQUFqQixDQUF1QixLQUF2QixHQUFrQyxLQUFLLFlBQXZDO0FBQ0EsV0FBSyxnQkFBTCxHQUF3QixTQUFTLE9BQU8sZ0JBQVAsQ0FBd0IsS0FBSyxXQUE3QixFQUEwQyxLQUFuRCxFQUEwRCxFQUExRCxDQUF4QjtBQUNBLFdBQUssVUFBTCxHQUFrQixLQUFLLGlCQUFMLEdBQXlCLEVBQTNDO0FBQ0EsV0FBSyxVQUFMLEdBQW1CLEtBQUssaUJBQUwsR0FBeUIsS0FBSyxZQUEvQixHQUErQyxLQUFLLGdCQUFwRCxHQUF1RSxFQUF6RjtBQUNEOzs7MEJBRUssQyxFQUFHO0FBQ1AsUUFBRSxjQUFGOztBQUVBLFdBQUssT0FBTCxHQUFnQixFQUFFLEtBQUgsR0FBWSxFQUFFLEtBQWQsR0FBc0IsRUFBRSxPQUFGLENBQVUsQ0FBVixFQUFhLEtBQWxEO0FBQ0EsV0FBSyxXQUFMO0FBQ0Q7OztnQ0FFVyxDLEVBQUc7QUFDYixRQUFFLGNBQUY7O0FBRUEsVUFBTSxTQUFVLEVBQUUsS0FBSCxHQUFZLEVBQUUsS0FBZCxHQUFzQixFQUFFLE9BQUYsQ0FBVSxDQUFWLEVBQWEsS0FBbEQ7QUFDQSxVQUFNLGFBQWEsS0FBSyxXQUFMLENBQWlCLHFCQUFqQixHQUF5QyxJQUF6QyxHQUFnRCxTQUFTLElBQVQsQ0FBYyxVQUFqRjtBQUNBLFdBQUssSUFBTCxHQUFhLGFBQWEsS0FBSyxnQkFBbkIsR0FBdUMsTUFBbkQ7QUFDQSxXQUFLLFVBQUwsR0FBa0IsSUFBbEI7QUFDRDs7OzhCQUVTLEMsRUFBRztBQUNYLFFBQUUsY0FBRjtBQUNBLFdBQUssVUFBTCxHQUFrQixLQUFsQjtBQUNEOzs7MkJBRU0sQyxFQUFHO0FBQ1IsUUFBRSxjQUFGOztBQUVBLFVBQUksQ0FBQyxLQUFLLFVBQVYsRUFBc0I7QUFDcEI7QUFDRDs7QUFFRCxXQUFLLEtBQUwsR0FBYyxFQUFFLEtBQUgsR0FBWSxFQUFFLEtBQWQsR0FBc0IsRUFBRSxPQUFGLENBQVUsQ0FBVixFQUFhLEtBQWhEO0FBQ0EsV0FBSyxPQUFMLEdBQWdCLEtBQUssS0FBTCxHQUFhLEtBQUssSUFBbkIsR0FBMkIsS0FBSyxnQkFBL0M7O0FBRUEsV0FBSyxXQUFMO0FBQ0Q7OzsyQkFFTTtBQUNMLFVBQUksS0FBSyxPQUFMLEdBQWUsS0FBSyxVQUF4QixFQUFvQztBQUNsQyxhQUFLLE9BQUwsR0FBZSxLQUFLLFVBQXBCO0FBQ0QsT0FGRCxNQUVPLElBQUksS0FBSyxPQUFMLEdBQWUsS0FBSyxVQUF4QixFQUFvQztBQUN6QyxhQUFLLE9BQUwsR0FBZSxLQUFLLFVBQXBCO0FBQ0Q7O0FBRUQsVUFBSSxZQUFhLEtBQUssT0FBTCxHQUFnQixLQUFLLGdCQUFMLEdBQXdCLENBQXpDLEdBQStDLEtBQUssaUJBQXBFO0FBQ0EsbUJBQWEsS0FBSyxZQUFsQjtBQUNBLFVBQU0sUUFBVyxZQUFZLEdBQXZCLE1BQU47O0FBRUEsV0FBSyxXQUFMLENBQWlCLEtBQWpCLENBQXVCLElBQXZCLEdBQThCLEtBQTlCO0FBQ0EsV0FBSyxhQUFMLENBQW1CLEtBQW5CLENBQXlCLEtBQXpCLEdBQWlDLEtBQWpDOztBQUVBLFVBQUksS0FBSyxPQUFMLENBQWEsWUFBakIsRUFBK0I7QUFDN0IsYUFBSyxPQUFMLENBQWEsWUFBYixDQUEwQixTQUExQjtBQUNEO0FBQ0Y7OztrQ0FFYTtBQUNaLGFBQU8scUJBQVAsQ0FBNkIsS0FBSyxJQUFMLENBQVUsSUFBVixDQUFlLElBQWYsQ0FBN0I7QUFDRDs7Ozs7O0FBR0gsT0FBTyxRQUFQLEdBQWtCO0FBQ2hCLHVCQUFxQixjQURMO0FBRWhCLGdCQUFjO0FBRkUsQ0FBbEI7O0FBS0EsT0FBTyxPQUFQLEdBQWlCLE1BQWpCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImNsYXNzIENvY29lbiB7XG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBDb2NvZW4uZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQgfHwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvY29lbicpO1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBpbml0KCkge1xuICAgIC8vIElmIGFscmVhZHkgYWN0aXZlLCBlc2NhcGVcbiAgICBpZiAodGhpcy5pc0FjdGl2ZSkgcmV0dXJuO1xuICAgIHRoaXMuY3JlYXRlRWxlbWVudHMoKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5kaW1lbnNpb25zKCk7XG5cbiAgICAvLyBTZXQgZmxhZ1xuICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICBpZiAoIXRoaXMuaXNBY3RpdmUpIHJldHVybjtcblxuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLmRlc3Ryb3lFbGVtZW50cygpO1xuICAgIHRoaXMuY2xlYW5VcCgpO1xuXG4gICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xuICB9XG5cbiAgY3JlYXRlRWxlbWVudHMoKSB7XG4gICAgLy8gQ3JlYXRlIGRyYWcgZWxlbWVudFxuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgc3Bhbi5jbGFzc05hbWUgPSB0aGlzLm9wdGlvbnMuZHJhZ0VsZW1lbnRTZWxlY3Rvci5yZXBsYWNlKCcuJywgJycpO1xuICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChzcGFuKTtcbiAgICAvLyBXcmFwIGZpcnN0IGltYWdlIGluIGRpdlxuICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBmaXJzdEltYWdlID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZzpmaXJzdC1jaGlsZCcpO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZmlyc3RJbWFnZS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgIGZpcnN0SW1hZ2UucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQod3JhcHBlciwgZmlyc3RJbWFnZSk7XG4gICAgLy8gU2V0IGNsYXNzIGVsZW1lbnRzIHdlIG5lZWQgbGF0ZXJcbiAgICB0aGlzLmRyYWdFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmRyYWdFbGVtZW50U2VsZWN0b3IpO1xuICAgIHRoaXMuYmVmb3JlRWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdkaXY6Zmlyc3QtY2hpbGQnKTtcbiAgICB0aGlzLmJlZm9yZUltYWdlID0gdGhpcy5iZWZvcmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuICB9XG5cbiAgZGVzdHJveUVsZW1lbnRzKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZXBsYWNlQ2hpbGQodGhpcy5iZWZvcmVJbWFnZSwgdGhpcy5iZWZvcmVFbGVtZW50KTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5kcmFnRWxlbWVudCk7XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uVGFwLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uRHJhZy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vbkRyYWcuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5kcmFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uRHJhZ1N0YXJ0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZHJhZ0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25EcmFnU3RhcnQuYmluZCh0aGlzKSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMub25EcmFnRW5kLmJpbmQodGhpcykpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmRpbWVuc2lvbnMuYmluZCh0aGlzKSk7XG4gIH1cblxuICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uVGFwLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uRHJhZy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vbkRyYWcuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5kcmFnRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uRHJhZ1N0YXJ0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZHJhZ0VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25EcmFnU3RhcnQuYmluZCh0aGlzKSk7XG5cbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMub25EcmFnRW5kLmJpbmQodGhpcykpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmRpbWVuc2lvbnMuYmluZCh0aGlzKSk7XG4gIH1cblxuICBjbGVhblVwKCkge1xuICAgIHRoaXMuZHJhZ0VsZW1lbnQgPSBudWxsO1xuICAgIHRoaXMuYmVmb3JlRWxlbWVudCA9IG51bGw7XG4gICAgdGhpcy5iZWZvcmVJbWFnZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnd2lkdGgnKTtcbiAgfVxuXG4gIGRpbWVuc2lvbnMoKSB7XG4gICAgdGhpcy5lbGVtZW50V2lkdGggPSBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpLndpZHRoLCAxMCk7XG4gICAgdGhpcy5lbGVtZW50T2Zmc2V0TGVmdCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0O1xuICAgIHRoaXMuYmVmb3JlSW1hZ2Uuc3R5bGUud2lkdGggPSBgJHt0aGlzLmVsZW1lbnRXaWR0aH1weGA7XG4gICAgdGhpcy5kcmFnRWxlbWVudFdpZHRoID0gcGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5kcmFnRWxlbWVudCkud2lkdGgsIDEwKTtcbiAgICB0aGlzLm1pbkxlZnRQb3MgPSB0aGlzLmVsZW1lbnRPZmZzZXRMZWZ0ICsgMTA7XG4gICAgdGhpcy5tYXhMZWZ0UG9zID0gKHRoaXMuZWxlbWVudE9mZnNldExlZnQgKyB0aGlzLmVsZW1lbnRXaWR0aCkgLSB0aGlzLmRyYWdFbGVtZW50V2lkdGggLSAxMDtcbiAgfVxuXG4gIG9uVGFwKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICB0aGlzLmxlZnRQb3MgPSAoZS5wYWdlWCkgPyBlLnBhZ2VYIDogZS50b3VjaGVzWzBdLnBhZ2VYO1xuICAgIHRoaXMucmVxdWVzdERyYWcoKTtcbiAgfVxuXG4gIG9uRHJhZ1N0YXJ0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBzdGFydFggPSAoZS5wYWdlWCkgPyBlLnBhZ2VYIDogZS50b3VjaGVzWzBdLnBhZ2VYO1xuICAgIGNvbnN0IG9mZnNldExlZnQgPSB0aGlzLmRyYWdFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG4gICAgdGhpcy5wb3NYID0gKG9mZnNldExlZnQgKyB0aGlzLmRyYWdFbGVtZW50V2lkdGgpIC0gc3RhcnRYO1xuICAgIHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG4gIH1cblxuICBvbkRyYWdFbmQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgfVxuXG4gIG9uRHJhZyhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYgKCF0aGlzLmlzRHJhZ2dpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLm1vdmVYID0gKGUucGFnZVgpID8gZS5wYWdlWCA6IGUudG91Y2hlc1swXS5wYWdlWDtcbiAgICB0aGlzLmxlZnRQb3MgPSAodGhpcy5tb3ZlWCArIHRoaXMucG9zWCkgLSB0aGlzLmRyYWdFbGVtZW50V2lkdGg7XG5cbiAgICB0aGlzLnJlcXVlc3REcmFnKCk7XG4gIH1cblxuICBkcmFnKCkge1xuICAgIGlmICh0aGlzLmxlZnRQb3MgPCB0aGlzLm1pbkxlZnRQb3MpIHtcbiAgICAgIHRoaXMubGVmdFBvcyA9IHRoaXMubWluTGVmdFBvcztcbiAgICB9IGVsc2UgaWYgKHRoaXMubGVmdFBvcyA+IHRoaXMubWF4TGVmdFBvcykge1xuICAgICAgdGhpcy5sZWZ0UG9zID0gdGhpcy5tYXhMZWZ0UG9zO1xuICAgIH1cblxuICAgIGxldCBvcGVuUmF0aW8gPSAodGhpcy5sZWZ0UG9zICsgKHRoaXMuZHJhZ0VsZW1lbnRXaWR0aCAvIDIpKSAtIHRoaXMuZWxlbWVudE9mZnNldExlZnQ7XG4gICAgb3BlblJhdGlvIC89IHRoaXMuZWxlbWVudFdpZHRoO1xuICAgIGNvbnN0IHdpZHRoID0gYCR7b3BlblJhdGlvICogMTAwfSVgO1xuXG4gICAgdGhpcy5kcmFnRWxlbWVudC5zdHlsZS5sZWZ0ID0gd2lkdGg7XG4gICAgdGhpcy5iZWZvcmVFbGVtZW50LnN0eWxlLndpZHRoID0gd2lkdGg7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmRyYWdDYWxsYmFjaykge1xuICAgICAgdGhpcy5vcHRpb25zLmRyYWdDYWxsYmFjayhvcGVuUmF0aW8pO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3REcmFnKCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmFnLmJpbmQodGhpcykpO1xuICB9XG59XG5cbkNvY29lbi5kZWZhdWx0cyA9IHtcbiAgZHJhZ0VsZW1lbnRTZWxlY3RvcjogJy5jb2NvZW4tZHJhZycsXG4gIGRyYWdDYWxsYmFjazogbnVsbCxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ29jb2VuO1xuIl19"}